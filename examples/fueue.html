<html>
<head>
<title>fueue.hs</title>
<style type="text/css">
body { background-color: #000000 }
.whitespace { color: #aaaaaa }
.qvarid { font-weight: bolder; color: #ffff00 }
.qconid { color: #00ffff }
.qvarsym { color: #ff00ff }
.qconsym { color: #ab0010 }
.literal { color: #ffffff }
.special { color: #ff0000 }
.reservedop { color: #00ab10 }
.reservedid { color: #00ff00 }
</style>
<body>
<pre>
<span class="whitespace">{-# LANGUAGE ViewPatterns #-}

{-# OPTIONS_GHC -Wall -Werror #-}
</span><span class="reservedid">module</span><span class="whitespace"> </span><span class="qconid">Main</span><span class="whitespace"> </span><span class="reservedid">where</span><span class="whitespace">

</span><span class="reservedid">import</span><span class="whitespace"> </span><span class="qconid">Control.Applicative</span><span class="whitespace"> </span><span class="qvarid">hiding</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">empty</span><span class="special">)</span><span class="whitespace">
</span><span class="reservedid">import</span><span class="whitespace"> </span><span class="qconid">Control.Monad.State.Strict</span><span class="whitespace">
</span><span class="reservedid">import</span><span class="whitespace"> </span><span class="qconid">Control.Monad.Trans.Maybe</span><span class="whitespace">

</span><span class="reservedid">import</span><span class="whitespace"> </span><span class="qconid">Data.Char</span><span class="whitespace">
</span><span class="reservedid">import</span><span class="whitespace"> </span><span class="qconid">Data.Foldable</span><span class="whitespace">
</span><span class="reservedid">import</span><span class="whitespace"> </span><span class="qconid">Data.Monoid</span><span class="whitespace">
</span><span class="reservedid">import</span><span class="whitespace"> </span><span class="qconid">Data.Sequence</span><span class="whitespace">

</span><span class="reservedid">import</span><span class="whitespace"> </span><span class="qconid">Numeric.Natural</span><span class="whitespace">

</span><span class="reservedid">import</span><span class="whitespace"> </span><span class="qconid">System.Environment</span><span class="whitespace">
</span><span class="reservedid">import</span><span class="whitespace"> </span><span class="qconid">System.IO</span><span class="whitespace">

</span><span class="reservedid">import</span><span class="whitespace"> </span><span class="qconid">Text.Parsec</span><span class="whitespace"> </span><span class="qvarid">hiding</span><span class="whitespace"> </span><span class="special">(</span><span class="special">(</span><span class="qvarsym"><|></span><span class="special">)</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">many</span><span class="special">)</span><span class="whitespace">
</span><span class="reservedid">import</span><span class="whitespace"> </span><span class="qconid">Text.Parsec.String</span><span class="whitespace">

</span><span class="reservedid">import</span><span class="whitespace"> </span><span class="qconid">Prelude</span><span class="whitespace"> </span><span class="qvarid">hiding</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">length</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">replicate</span><span class="special">)</span><span class="whitespace">

</span><span class="reservedid">data</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qconid">FPlus</span><span class="whitespace"> </span><span class="reservedop">|</span><span class="whitespace"> </span><span class="qconid">FMinus</span><span class="whitespace"> </span><span class="reservedop">|</span><span class="whitespace"> </span><span class="qconid">FMult</span><span class="whitespace"> </span><span class="reservedop">|</span><span class="whitespace"> </span><span class="qconid">FDiv</span><span class="whitespace"> </span><span class="reservedop">|</span><span class="whitespace"> </span><span class="qconid">FInv</span><span class="whitespace"> </span><span class="reservedop">|</span><span class="whitespace"> </span><span class="qconid">FDup</span><span class="whitespace"> </span><span class="reservedop">|</span><span class="whitespace"> </span><span class="qconid">FSwap</span><span class="whitespace"> </span><span class="reservedop">|</span><span class="whitespace"> </span><span class="qconid">FPop</span><span class="whitespace"> </span><span class="reservedop">|</span><span class="whitespace"> </span><span class="qconid">FCopy</span><span class="whitespace"> </span><span class="reservedop">|</span><span class="whitespace"> </span><span class="qconid">FBlockify</span><span class="whitespace"> </span><span class="reservedop">|</span><span class="whitespace"> </span><span class="qconid">FAppend</span><span class="whitespace"> </span><span class="reservedop">|</span><span class="whitespace"> </span><span class="qconid">FDeblock</span><span class="whitespace"> </span><span class="reservedop">|</span><span class="whitespace"> </span><span class="qconid">FHalt</span><span class="whitespace"> </span><span class="reservedop">|</span><span class="whitespace"> </span><span class="qconid">FBlock</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">|</span><span class="whitespace"> </span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="qconid">Integer</span><span class="whitespace"> </span><span class="reservedop">|</span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedid">deriving</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">Eq</span><span class="special">)</span><span class="whitespace">

</span><span class="reservedid">type</span><span class="whitespace"> </span><span class="qconid">Fueue</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qconid">StateT</span><span class="whitespace"> </span><span class="qconid">Natural</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">MaybeT</span><span class="whitespace"> </span><span class="qconid">IO</span><span class="special">)</span><span class="whitespace">

</span><span class="qvarid">main</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">IO</span><span class="whitespace"> </span><span class="special">(</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">main</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="reservedid">do</span><span class="whitespace">
  </span><span class="qvarid">hSetBuffering</span><span class="whitespace"> </span><span class="qvarid">stdout</span><span class="whitespace"> </span><span class="qconid">NoBuffering</span><span class="whitespace">
  </span><span class="qvarid">args</span><span class="whitespace"> </span><span class="reservedop"><-</span><span class="whitespace"> </span><span class="qvarid">getArgs</span><span class="whitespace">
  </span><span class="qvarid">interp</span><span class="whitespace"> </span><span class="reservedop"><-</span><span class="whitespace"> </span><span class="qvarid">getProgName</span><span class="whitespace">
  </span><span class="special">(</span><span class="qvarid">filename</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">program</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop"><-</span><span class="whitespace"> </span><span class="reservedid">case</span><span class="whitespace"> </span><span class="qvarid">args</span><span class="whitespace"> </span><span class="reservedid">of</span><span class="whitespace">
    </span><span class="special">[</span><span class="literal">"-e"</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">p</span><span class="special">]</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qvarid">return</span><span class="whitespace"> </span><span class="special">(</span><span class="literal">"command line"</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">p</span><span class="special">)</span><span class="whitespace">
    </span><span class="special">[</span><span class="qvarid">f</span><span class="special">]</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="special">(</span><span class="special">,</span><span class="special">)</span><span class="whitespace"> </span><span class="qvarid">f</span><span class="whitespace"> </span><span class="qvarsym"><$></span><span class="whitespace"> </span><span class="qvarid">readFile</span><span class="whitespace"> </span><span class="qvarid">f</span><span class="whitespace">
    </span><span class="special">[</span><span class="special">]</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="special">(</span><span class="special">,</span><span class="special">)</span><span class="whitespace"> </span><span class="literal">"stdin"</span><span class="whitespace"> </span><span class="qvarsym"><$></span><span class="whitespace"> </span><span class="qvarid">getContents</span><span class="whitespace">
    </span><span class="reservedid">_</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qvarid">error</span><span class="whitespace"> </span><span class="qvarsym">$</span><span class="whitespace"> </span><span class="qvarid">unlines</span><span class="whitespace"> </span><span class="special">[</span><span class="whitespace">
      </span><span class="literal">""</span><span class="special">,</span><span class="whitespace">
      </span><span class="literal">"Usage: "</span><span class="special">,</span><span class="whitespace">
      </span><span class="qvarid">interp</span><span class="whitespace"> </span><span class="qvarsym">++</span><span class="whitespace"> </span><span class="literal">" <filename"</span><span class="special">,</span><span class="whitespace">
      </span><span class="qvarid">interp</span><span class="whitespace"> </span><span class="qvarsym">++</span><span class="whitespace"> </span><span class="literal">" -e <program text>"</span><span class="special">,</span><span class="whitespace">
      </span><span class="qvarid">interp</span><span class="special">,</span><span class="whitespace">
      </span><span class="literal">"Note: No argument gives the program as input. No further input can then"</span><span class="special">,</span><span class="whitespace">
      </span><span class="literal">"be given to the program."</span><span class="special">]</span><span class="whitespace">
  </span><span class="reservedid">case</span><span class="whitespace"> </span><span class="qvarid">parseFueue</span><span class="whitespace"> </span><span class="qvarid">filename</span><span class="whitespace"> </span><span class="qvarid">program</span><span class="whitespace"> </span><span class="reservedid">of</span><span class="whitespace">
    </span><span class="qconid">Left</span><span class="whitespace"> </span><span class="qvarid">err</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qvarid">print</span><span class="whitespace"> </span><span class="qvarid">err</span><span class="whitespace">
    </span><span class="qconid">Right</span><span class="whitespace"> </span><span class="qvarid">fueue</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qvarid">finalRun</span><span class="whitespace"> </span><span class="qvarid">fueue</span><span class="whitespace">
      

</span><span class="qvarid">mushCaches</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace">
</span><span class="qvarid">mushCaches</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewr</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewr</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace"> </span><span class="qconsym">:></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="qvarid">cache1</span><span class="special">)</span><span class="whitespace"> </span><span class="qconsym">:></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="qvarid">cache2</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">cache1</span><span class="whitespace"> </span><span class="qvarsym">><</span><span class="whitespace"> </span><span class="qvarid">cache2</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">mushCaches</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace">

</span><span class="qvarid">inCache</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace">
</span><span class="qvarid">inCache</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewr</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace"> </span><span class="qconsym">:></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="qvarid">cache</span><span class="special">)</span><span class="whitespace"> </span><span class="qvarid">item</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">cache</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qvarid">item</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">inCache</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace"> </span><span class="qvarid">item</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">singleton</span><span class="whitespace"> </span><span class="qvarid">item</span><span class="special">)</span><span class="whitespace">


</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Fueue</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewl</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">EmptyL</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">error</span><span class="whitespace"> </span><span class="literal">"Taneb's done something stupid!"</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewQueueNum</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Just</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FPlus</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">arg2</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">arg1</span><span class="whitespace"> </span><span class="qvarsym">+</span><span class="whitespace"> </span><span class="qvarid">arg2</span><span class="special">)</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">put</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewQueue2</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Just</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FMinus</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">negate</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">)</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">put</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewQueueNum</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Just</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FMult</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">arg2</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">arg1</span><span class="whitespace"> </span><span class="qvarsym">*</span><span class="whitespace"> </span><span class="qvarid">arg2</span><span class="special">)</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">put</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewQueueNum</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Just</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FDiv</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">arg2</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">arg1</span><span class="whitespace"> </span><span class="special">`</span><span class="qvarid">div</span><span class="special">`</span><span class="whitespace"> </span><span class="qvarid">arg2</span><span class="special">)</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">put</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewQueue2</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Just</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FInv</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="literal">0</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="literal">1</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">put</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewQueue2</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Just</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FInv</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="reservedid">_</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">put</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewQueue2</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Just</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FDup</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">put</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewQueue3</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Just</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FSwap</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">arg2</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qvarid">arg2</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">put</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewQueue2</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Just</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FPop</span><span class="special">,</span><span class="whitespace"> </span><span class="reservedid">_</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="qvarid">empty</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">put</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewQueue3</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Just</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FCopy</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">arg2</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">rest</span><span class="whitespace"> </span><span class="qvarsym">><</span><span class="whitespace"> </span><span class="qvarid">replicate</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">fromInteger</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">)</span><span class="whitespace"> </span><span class="qvarid">arg2</span><span class="special">)</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="qvarid">empty</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">put</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewQueue2</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Just</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FBlockify</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FBlock</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">singleton</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">)</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">put</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewQueue3</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Just</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FAppend</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">FBlock</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">arg2</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FBlock</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">arg1</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qvarid">arg2</span><span class="special">)</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">put</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewQueue2</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Just</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FDeblock</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">FBlock</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">rest</span><span class="whitespace"> </span><span class="qvarsym">><</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">)</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="qvarid">empty</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">put</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewl</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">FHalt</span><span class="whitespace"> </span><span class="qconsym">:<</span><span class="whitespace"> </span><span class="reservedid">_</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">mzero</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewl</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="whitespace"> </span><span class="qconsym">:<</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="qvarid">empty</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">put</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace"> </span><span class="qvarsym">*></span><span class="whitespace"> </span><span class="qvarid">liftIO</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">putChar</span><span class="whitespace"> </span><span class="qvarsym">.</span><span class="whitespace"> </span><span class="qvarid">chr</span><span class="whitespace"> </span><span class="qvarsym">$</span><span class="whitespace"> </span><span class="qvarid">fromInteger</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">)</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewl</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewr</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">EmptyR</span><span class="special">)</span><span class="whitespace"> </span><span class="qconsym">:<</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">pure</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewl</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewr</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewr</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qvarid">newCache</span><span class="whitespace"> </span><span class="qconsym">:></span><span class="whitespace"> </span><span class="qconid">FAppend</span><span class="special">)</span><span class="whitespace"> </span><span class="qconsym">:></span><span class="whitespace"> </span><span class="qconid">FBlock</span><span class="whitespace"> </span><span class="qvarid">block</span><span class="special">)</span><span class="whitespace"> </span><span class="qconsym">:<</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FAppend</span><span class="whitespace"> </span><span class="qvarsym"><|</span><span class="whitespace"> </span><span class="qconid">FBlock</span><span class="whitespace"> </span><span class="qvarid">block</span><span class="whitespace"> </span><span class="qvarsym"><|</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="special">)</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="qvarid">newCache</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">modify</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarsym">+</span><span class="whitespace"> </span><span class="qvarid">fromIntegral</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">length</span><span class="whitespace"> </span><span class="qvarid">newCache</span><span class="special">)</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewl</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewr</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewr</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qvarid">newCache</span><span class="whitespace"> </span><span class="qconsym">:></span><span class="whitespace"> </span><span class="qconid">FDeblock</span><span class="special">)</span><span class="whitespace"> </span><span class="qconsym">:></span><span class="whitespace"> </span><span class="qconid">FBlock</span><span class="whitespace"> </span><span class="qvarid">block</span><span class="special">)</span><span class="whitespace"> </span><span class="qconsym">:<</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FDeblock</span><span class="whitespace"> </span><span class="qvarsym"><|</span><span class="whitespace"> </span><span class="qconid">FBlock</span><span class="whitespace"> </span><span class="qvarid">block</span><span class="whitespace"> </span><span class="qvarsym"><|</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="special">)</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="qvarid">newCache</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">modify</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarsym">+</span><span class="whitespace"> </span><span class="qvarid">fromIntegral</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">length</span><span class="whitespace"> </span><span class="qvarid">newCache</span><span class="special">)</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewl</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewr</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qvarid">newCache</span><span class="whitespace"> </span><span class="qconsym">:></span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="special">)</span><span class="whitespace"> </span><span class="qconsym">:<</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="whitespace"> </span><span class="qvarsym"><|</span><span class="whitespace"> </span><span class="qvarid">mushCaches</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">queue</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="qvarid">newCache</span><span class="special">)</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">modify</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarsym">+</span><span class="whitespace"> </span><span class="qvarid">fromIntegral</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">length</span><span class="whitespace"> </span><span class="qvarid">newCache</span><span class="special">)</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewl</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="whitespace"> </span><span class="qconsym">:<</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace"> </span><span class="special">`</span><span class="qvarid">inCache</span><span class="special">`</span><span class="whitespace"> </span><span class="qvarid">arg1</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">modify</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarsym">+</span><span class="whitespace"> </span><span class="literal">1</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">step</span><span class="whitespace"> </span><span class="reservedid">_</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">error</span><span class="whitespace"> </span><span class="literal">"Taneb's done something foolish!"</span><span class="whitespace">


</span><span class="qvarid">viewQueue1</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Maybe</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FueueItem</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">viewQueue1</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewl</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">EmptyL</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qconid">Nothing</span><span class="whitespace">
</span><span class="qvarid">viewQueue1</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewl</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewl</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">EmptyL</span><span class="special">)</span><span class="whitespace"> </span><span class="qconsym">:<</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">viewQueue1</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="whitespace">
</span><span class="qvarid">viewQueue1</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewl</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewl</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qvarid">a</span><span class="whitespace"> </span><span class="qconsym">:<</span><span class="whitespace"> </span><span class="qvarid">newCache</span><span class="special">)</span><span class="whitespace"> </span><span class="qconsym">:<</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qconid">Just</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">a</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="qvarid">newCache</span><span class="whitespace"> </span><span class="qvarsym"><|</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">viewQueue1</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">viewl</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qvarid">a</span><span class="whitespace"> </span><span class="qconsym">:<</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qconid">Just</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">a</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">viewQueue1</span><span class="whitespace"> </span><span class="reservedid">_</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">error</span><span class="whitespace"> </span><span class="literal">"Taneb's done something idiotic!"</span><span class="whitespace">

</span><span class="qvarid">viewQueue2</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Maybe</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FueueItem</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">viewQueue2</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="reservedid">do</span><span class="whitespace">
  </span><span class="special">(</span><span class="qvarid">a</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">queue'</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop"><-</span><span class="whitespace"> </span><span class="qvarid">viewQueue1</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace">
  </span><span class="special">(</span><span class="qvarid">b</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop"><-</span><span class="whitespace"> </span><span class="qvarid">viewQueue1</span><span class="whitespace"> </span><span class="qvarid">queue'</span><span class="whitespace">
  </span><span class="qvarid">return</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">a</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">b</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="whitespace">

</span><span class="qvarid">viewQueue3</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Maybe</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FueueItem</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">viewQueue3</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="reservedid">do</span><span class="whitespace">
  </span><span class="special">(</span><span class="qvarid">a</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">b</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">queue'</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop"><-</span><span class="whitespace"> </span><span class="qvarid">viewQueue2</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace">
  </span><span class="special">(</span><span class="qvarid">c</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop"><-</span><span class="whitespace"> </span><span class="qvarid">viewQueue1</span><span class="whitespace"> </span><span class="qvarid">queue'</span><span class="whitespace">
  </span><span class="qvarid">return</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">a</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">b</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">c</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="whitespace">

</span><span class="qvarid">viewQueueNum</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Maybe</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FueueItem</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">Integer</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">Integer</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">viewQueueNum</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="reservedid">do</span><span class="whitespace">
  </span><span class="special">(</span><span class="qvarid">op</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">queue'</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop"><-</span><span class="whitespace"> </span><span class="qvarid">viewQueue1</span><span class="whitespace"> </span><span class="qvarid">queue</span><span class="whitespace">
  </span><span class="special">(</span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="qvarid">a</span><span class="special">,</span><span class="whitespace"> </span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="qvarid">b</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop"><-</span><span class="whitespace"> </span><span class="qvarid">viewQueue2</span><span class="whitespace"> </span><span class="qvarid">queue'</span><span class="whitespace">
  </span><span class="qvarid">return</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">op</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">a</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">b</span><span class="special">,</span><span class="whitespace"> </span><span class="qvarid">rest</span><span class="special">)</span><span class="whitespace">

</span><span class="qvarid">lengthOfFueue</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Natural</span><span class="whitespace">
</span><span class="qvarid">lengthOfFueue</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">fromInteger</span><span class="whitespace"> </span><span class="qvarsym">.</span><span class="whitespace"> </span><span class="qvarid">getSum</span><span class="whitespace"> </span><span class="qvarsym">.</span><span class="whitespace"> </span><span class="qvarid">foldMap</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">Sum</span><span class="whitespace"> </span><span class="qvarsym">.</span><span class="whitespace"> </span><span class="qvarid">fueueItemLength</span><span class="special">)</span><span class="whitespace">
  </span><span class="reservedid">where</span><span class="whitespace"> </span><span class="qvarid">fueueItemLength</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="qvarid">cache</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">fromIntegral</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">length</span><span class="whitespace"> </span><span class="qvarid">cache</span><span class="special">)</span><span class="whitespace">
        </span><span class="qvarid">fueueItemLength</span><span class="whitespace"> </span><span class="reservedid">_</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">1</span><span class="whitespace">
                                  
</span><span class="qvarid">check</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Fueue</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">check</span><span class="whitespace"> </span><span class="qvarid">prog</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="reservedid">do</span><span class="whitespace">
  </span><span class="qvarid">time</span><span class="whitespace"> </span><span class="reservedop"><-</span><span class="whitespace"> </span><span class="qvarid">get</span><span class="whitespace">
  </span><span class="reservedid">if</span><span class="whitespace"> </span><span class="qvarid">time</span><span class="whitespace"> </span><span class="qvarsym">>=</span><span class="whitespace"> </span><span class="qvarid">lengthOfFueue</span><span class="whitespace"> </span><span class="qvarid">prog</span><span class="whitespace">
     </span><span class="reservedid">then</span><span class="whitespace"> </span><span class="reservedid">do</span><span class="whitespace">
          </span><span class="qvarid">put</span><span class="whitespace"> </span><span class="literal">0</span><span class="whitespace">
          </span><span class="qvarid">c</span><span class="whitespace"> </span><span class="reservedop"><-</span><span class="whitespace"> </span><span class="qvarid">toInteger</span><span class="whitespace"> </span><span class="qvarsym">.</span><span class="whitespace"> </span><span class="qvarid">ord</span><span class="whitespace"> </span><span class="qvarsym"><$></span><span class="whitespace"> </span><span class="qvarid">liftIO</span><span class="whitespace"> </span><span class="qvarid">getChar</span><span class="whitespace">
          </span><span class="qvarid">return</span><span class="whitespace"> </span><span class="qvarsym">$</span><span class="whitespace"> </span><span class="qvarid">prog</span><span class="whitespace"> </span><span class="qvarsym">|></span><span class="whitespace"> </span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="qvarid">c</span><span class="whitespace">
     </span><span class="reservedid">else</span><span class="whitespace"> </span><span class="qvarid">return</span><span class="whitespace"> </span><span class="qvarid">prog</span><span class="whitespace">

</span><span class="qvarid">bigStep</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Fueue</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">bigStep</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">check</span><span class="whitespace"> </span><span class="qvarsym">>=></span><span class="whitespace"> </span><span class="qvarid">step</span><span class="whitespace">

</span><span class="qvarid">run</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Fueue</span><span class="whitespace"> </span><span class="qvarid">a</span><span class="whitespace">
</span><span class="qvarid">run</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">bigStep</span><span class="whitespace"> </span><span class="qvarsym">>=></span><span class="whitespace"> </span><span class="qvarid">run</span><span class="whitespace">

</span><span class="qvarid">finalRun</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">IO</span><span class="whitespace"> </span><span class="special">(</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">finalRun</span><span class="whitespace"> </span><span class="qvarid">prog</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="special">(</span><span class="special">)</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">runMaybeT</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">evalStateT</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">run</span><span class="whitespace"> </span><span class="qvarid">prog</span><span class="special">)</span><span class="whitespace"> </span><span class="literal">0</span><span class="special">)</span><span class="whitespace">

</span><span class="qvarid">parseFueue</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">SourceName</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">String</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">Either</span><span class="whitespace"> </span><span class="qconid">ParseError</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">parseFueue</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">parse</span><span class="whitespace"> </span><span class="qvarid">parseFueue1</span><span class="whitespace">

</span><span class="qvarid">parseFueue1</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">Parser</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">Seq</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="special">)</span><span class="whitespace">
</span><span class="qvarid">parseFueue1</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">fromList</span><span class="whitespace"> </span><span class="qvarsym"><$></span><span class="whitespace"> </span><span class="qvarid">manyTill</span><span class="whitespace"> </span><span class="qvarid">parseFueueItem</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">try</span><span class="whitespace"> </span><span class="qvarsym">$</span><span class="whitespace"> </span><span class="qvarid">spaces</span><span class="whitespace"> </span><span class="qvarsym">*></span><span class="whitespace"> </span><span class="qvarid">eof</span><span class="special">)</span><span class="whitespace">

</span><span class="qvarid">parseBlock</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">Parser</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace">
</span><span class="qvarid">parseBlock</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qconid">FBlock</span><span class="whitespace"> </span><span class="qvarsym">.</span><span class="whitespace"> </span><span class="qvarid">fromList</span><span class="whitespace"> </span><span class="qvarsym"><$></span><span class="whitespace"> </span><span class="qvarid">manyTill</span><span class="whitespace"> </span><span class="qvarid">parseFueueItem</span><span class="whitespace"> </span><span class="special">(</span><span class="qvarid">try</span><span class="whitespace"> </span><span class="qvarsym">$</span><span class="whitespace"> </span><span class="qvarid">spaces</span><span class="whitespace"> </span><span class="qvarsym">*></span><span class="whitespace"> </span><span class="qvarid">char</span><span class="whitespace"> </span><span class="literal">']'</span><span class="special">)</span><span class="whitespace">

</span><span class="qvarid">parseFueueItem</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">Parser</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace">
</span><span class="qvarid">parseFueueItem</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">spaces</span><span class="whitespace"> </span><span class="qvarsym">*></span><span class="whitespace"> </span><span class="special">(</span><span class="whitespace">
  </span><span class="qconid">FPlus</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">char</span><span class="whitespace"> </span><span class="literal">'+'</span><span class="whitespace"> </span><span class="qvarsym"><|></span><span class="whitespace">
  </span><span class="qconid">FMinus</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">char</span><span class="whitespace"> </span><span class="literal">'-'</span><span class="whitespace"> </span><span class="qvarsym"><|></span><span class="whitespace">
  </span><span class="qconid">FMult</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">char</span><span class="whitespace"> </span><span class="literal">'*'</span><span class="whitespace"> </span><span class="qvarsym"><|></span><span class="whitespace">
  </span><span class="qconid">FDiv</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">char</span><span class="whitespace"> </span><span class="literal">'/'</span><span class="whitespace"> </span><span class="qvarsym"><|></span><span class="whitespace">
  </span><span class="qconid">FInv</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">char</span><span class="whitespace"> </span><span class="literal">'%'</span><span class="whitespace"> </span><span class="qvarsym"><|></span><span class="whitespace">
  </span><span class="qconid">FDup</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">char</span><span class="whitespace"> </span><span class="literal">':'</span><span class="whitespace"> </span><span class="qvarsym"><|></span><span class="whitespace">
  </span><span class="qconid">FSwap</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">char</span><span class="whitespace"> </span><span class="literal">'~'</span><span class="whitespace"> </span><span class="qvarsym"><|></span><span class="whitespace">
  </span><span class="qconid">FPop</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">char</span><span class="whitespace"> </span><span class="literal">'!'</span><span class="whitespace"> </span><span class="qvarsym"><|></span><span class="whitespace">
  </span><span class="qconid">FCopy</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">char</span><span class="whitespace"> </span><span class="literal">'$'</span><span class="whitespace"> </span><span class="qvarsym"><|></span><span class="whitespace">
  </span><span class="qconid">FBlockify</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">char</span><span class="whitespace"> </span><span class="literal">'('</span><span class="whitespace"> </span><span class="qvarsym"><|></span><span class="whitespace">
  </span><span class="qconid">FAppend</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">char</span><span class="whitespace"> </span><span class="literal">'<'</span><span class="whitespace"> </span><span class="qvarsym"><|></span><span class="whitespace">
  </span><span class="qconid">FDeblock</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">char</span><span class="whitespace"> </span><span class="literal">')'</span><span class="whitespace"> </span><span class="qvarsym"><|></span><span class="whitespace">
  </span><span class="qconid">FHalt</span><span class="whitespace"> </span><span class="qvarsym"><$</span><span class="whitespace"> </span><span class="qvarid">char</span><span class="whitespace"> </span><span class="literal">'H'</span><span class="whitespace"> </span><span class="qvarsym"><|></span><span class="whitespace">
  </span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="qvarsym">.</span><span class="whitespace"> </span><span class="qvarid">read</span><span class="whitespace"> </span><span class="qvarsym"><$></span><span class="whitespace"> </span><span class="qvarid">many1</span><span class="whitespace"> </span><span class="qvarid">digit</span><span class="whitespace"> </span><span class="qvarsym"><|></span><span class="whitespace">
  </span><span class="qvarid">char</span><span class="whitespace"> </span><span class="literal">'['</span><span class="whitespace"> </span><span class="qvarsym">*></span><span class="whitespace"> </span><span class="qvarid">parseBlock</span><span class="whitespace">
  </span><span class="special">)</span><span class="whitespace">
                 
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="reservedop">::</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedop">-></span><span class="whitespace"> </span><span class="qconid">String</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qconid">FPlus</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">"+"</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qconid">FMinus</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">"-"</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qconid">FMult</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">"*"</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qconid">FDiv</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">"/"</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qconid">FInv</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">"%"</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qconid">FDup</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">":"</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qconid">FPop</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">"!"</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qconid">FSwap</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">"~"</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qconid">FCopy</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">"$"</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qconid">FBlockify</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">"("</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qconid">FAppend</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">"<"</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qconid">FDeblock</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">")"</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qconid">FHalt</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">"H"</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FNum</span><span class="whitespace"> </span><span class="qvarid">n</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">' '</span><span class="whitespace"> </span><span class="reservedop">:</span><span class="whitespace"> </span><span class="qvarid">show</span><span class="whitespace"> </span><span class="qvarid">n</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FBlock</span><span class="whitespace"> </span><span class="qvarid">block</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">'['</span><span class="whitespace"> </span><span class="reservedop">:</span><span class="whitespace"> </span><span class="qvarid">foldMap</span><span class="whitespace"> </span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qvarid">block</span><span class="whitespace"> </span><span class="qvarsym">++</span><span class="whitespace"> </span><span class="literal">"]"</span><span class="whitespace">
</span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="qvarid">cache</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="literal">'{'</span><span class="whitespace"> </span><span class="reservedop">:</span><span class="whitespace"> </span><span class="qvarid">foldMap</span><span class="whitespace"> </span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qvarid">cache</span><span class="whitespace"> </span><span class="qvarsym">++</span><span class="whitespace"> </span><span class="literal">"}"</span><span class="whitespace">

</span><span class="reservedid">instance</span><span class="whitespace"> </span><span class="qconid">Show</span><span class="whitespace"> </span><span class="qconid">FueueItem</span><span class="whitespace"> </span><span class="reservedid">where</span><span class="whitespace">
  </span><span class="qvarid">show</span><span class="whitespace"> </span><span class="special">(</span><span class="qconid">FCache</span><span class="whitespace"> </span><span class="qvarid">cache</span><span class="special">)</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">foldMap</span><span class="whitespace"> </span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qvarid">cache</span><span class="whitespace">
  </span><span class="qvarid">show</span><span class="whitespace"> </span><span class="qvarid">anythingElse</span><span class="whitespace"> </span><span class="reservedop">=</span><span class="whitespace"> </span><span class="qvarid">debugRender</span><span class="whitespace"> </span><span class="qvarid">anythingElse</span><span class="whitespace">
</span></pre></body>
